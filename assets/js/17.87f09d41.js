(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{338:function(s,t,a){"use strict";a.r(t);var n=a(3),r=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"webrtc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webrtc","aria-hidden":"true"}},[s._v("#")]),s._v(" webrtc")]),s._v(" "),a("blockquote",[a("p",[s._v("目前我部需要使用纯 webrtc 实现 Mobile - PC 的一个音视频监控功能,以下根据目前整理所得")])]),s._v(" "),a("h2",{attrs:{id:"webrtc-组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webrtc-组成","aria-hidden":"true"}},[s._v("#")]),s._v(" webrtc 组成")]),s._v(" "),a("ol",[a("li",[s._v("getUserMedia 是负责获取用户本地的多媒体数据，如调起摄像头录像等。")]),s._v(" "),a("li",[s._v("RTCPeerConnection 是负责建立 P2P 连接以及传输多媒体数据。")]),s._v(" "),a("li",[s._v("RTCDataChannel 是提供的一个信令通道，在游戏里面信令是实现互动的重要元素")])]),s._v(" "),a("h2",{attrs:{id:"各个模块的作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#各个模块的作用","aria-hidden":"true"}},[s._v("#")]),s._v(" 各个模块的作用")]),s._v(" "),a("h3",{attrs:{id:"getusermedia"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getusermedia","aria-hidden":"true"}},[s._v("#")]),s._v(" getUserMedia")]),s._v(" "),a("p",[s._v("作用： 负责获取用户本地的多媒体数据，（麦克风，摄像头，或屏幕），需要传入 3 个参数，")]),s._v(" "),a("ol",[a("li",[s._v("音视频设置")]),s._v(" "),a("li",[s._v("成功回调参数（successCallback）\n"),a("ul",[a("li",[s._v("successCallback：会生成的 mediastrem，可以直接 video 播放，后面传输的也既是该 stream，")])])]),s._v(" "),a("li",[s._v("失败回调参数（errorCallback）\n"),a("ul",[a("li",[s._v("errorCallback：会生成错误信息")])])])]),s._v(" "),a("h3",{attrs:{id:"rtcpeerconnection"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rtcpeerconnection","aria-hidden":"true"}},[s._v("#")]),s._v(" RTCPeerConnection")]),s._v(" "),a("blockquote",[a("p",[s._v("webrtc 最核心的 API "),a("code",[s._v("pc = new RTCPeerConnection（config）")]),s._v("用于创造 offer ，answer ， ICE 框架，以及音视频的传输；")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Offerr：")]),s._v(" "),a("ol",[a("li",[s._v("发出方调用 pc.createOffer，会生成本地的一个提供的音频信息 SDP（如生成音视频的格式，编码，版本号），")]),s._v(" "),a("li",[s._v("设置 setLocalDescription（offer）本地信息描述")]),s._v(" "),a("li",[s._v("通过 server 转发 offer 给接受端")])])]),s._v(" "),a("li",[a("p",[s._v("answer:")]),s._v(" "),a("ol",[a("li",[s._v("接受端向 server 发出请求，接受 offer，设置 setRemoteDescription（offer）发出端信息描述")]),s._v(" "),a("li",[s._v("调用 pc.createAnswer（），生成接受端的的 SDP 信息，即支持的音视频信息")]),s._v(" "),a("li",[s._v("接受端设置 setLocalDescription（answer）本地信息描述")]),s._v(" "),a("li",[s._v("通过 server 转发 answer 给发出端,发出端设置 setRemoteDescription（answer）接受端的信息描述,目前两端确认了连接信息，但还需要确认数据传输。")])])]),s._v(" "),a("li",[a("p",[s._v("ICE: 候选人信息（解析 2 端地址负责通信）")]),s._v(" "),a("ol",[a("li",[s._v("通过 ICE 框架建立 NAT/防火墙穿越的连接：")]),s._v(" "),a("li",[s._v("WebRTC 使用 ICE 框架来获得这个外界可以直接访问的地址，RTCPeerConnection 在创立的时候可以将 ICE 服务器的地址传递进去，即需要设置 config，配置 STUN,TUAN 负责打洞"),a("code",[s._v('eg： config = { "iceServers": [{ "url": "stun:stun.l.google.com:19302" }] }')])]),s._v(" "),a("li",[s._v("发出端调用 pc.onicecandidate，当 candidate 信息产生，通过 serve 发给接受端 ，接受端调用 PC.addIceCandidate 接受")]),s._v(" "),a("li",[s._v("接受端调用 pc.onicecandidate，当 candidate 信息产生，通过 serve 发给接受端 ，发出端调用 PC.addIceCandidate 接受")])])])]),s._v(" "),a("h4",{attrs:{id:"音视频传输过程："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#音视频传输过程：","aria-hidden":"true"}},[s._v("#")]),s._v(" 音视频传输过程：")]),s._v(" "),a("p",[s._v("以上几步完成后，就建立 了 P2P 连接，此时")]),s._v(" "),a("ol",[a("li",[s._v("发出端通过 PC.addStream（stream）将 getusermedia 采集的 stream 发送，")]),s._v(" "),a("li",[s._v("接受端通过 PC.onaddstream = function（e） ，监听 stream 的流入，此时将 stream 赋值给 video 标签实现播放")])]),s._v(" "),a("p",[s._v("目前了解到 webrtc 的 stream 传输协议为 UDP，音视频为打包方式为 RTP 包为音视频数据包,RTCP 为流的信息与控制的包(目前音频编码格式为 OPUS 视频编码格式默认为 VP8，webm 格式)")]),s._v(" "),a("h3",{attrs:{id:"附件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附件","aria-hidden":"true"}},[s._v("#")]),s._v(" 附件")]),s._v(" "),a("ol",[a("li",[s._v("Sdp 信息内容：")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//回话元数据")]),s._v("\nRTCSessionDescription "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"offer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nsdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(' "v'),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n↵o"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1788397897222265615")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v("\n↵s…"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3627")]),s._v(" label"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("c19a73d7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c40e"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("eac"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bec1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("719")]),s._v('c3bd8c8e6\n↵"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nsdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(' "v'),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//sdp 版本号")]),s._v("\n↵o"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1788397897222265615")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//回话编号  回话版本")]),s._v("\n↵s"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\n↵t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//会话的起始时间和结束时间，0代表没有限制")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("group"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BUNDLE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 表示需要共用一个传输通道传输的媒体，通过ssrc进行区分不同的流。如果没有这一行，音视频数据就会分别用单独udp端口来发送.")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("msid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("semantic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WMS")]),s._v(" KkpsjshfPosgbb1dOrXGfhlc2dLZfo9JDvBU  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//表示支持多个流")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//下面时流描述的部分")]),s._v("\n↵m"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("audio "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UDP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TLS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RTP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVPF")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("112")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("113")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("126")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// audio 表示有音频  9使用的端口号为9 // UDP/TLS/RTP/SAVPF是表示用户支持来传输音频的协议，udp,tls,rtp代表使用udp来传输rtp包，并使用tls加密")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// SAVPF代表使用srtcp的反馈机制来控制通信过程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//数字表示音频支持的编码c=IN IP4 0.0.0.0")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtcp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//以上不使用")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ice"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ufrag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OZTD")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ice"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("pwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("JdMV38GPXnSTYiqoakwPVpnD\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//与ice协商的安全验证信息")]),s._v("\n\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ice"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("trickle\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("fingerprint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("sha"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("C"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("E7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("E6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("62")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("C8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EC")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("F6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("F"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("D5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("F5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("04")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("A\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//以上这行是dtls协商过程中需要的认证信息")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("setup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("actpass\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("extmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" urn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("ietf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("rtp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("hdrext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("ssrc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("audio"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("level\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("extmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ietf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("draft"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("holmer"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rmcat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("transport"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("wide"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("extensions"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("extmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" urn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("ietf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("rtp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("hdrext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("sdes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mid\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("extmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" urn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("ietf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("rtp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("hdrext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("sdes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("rtp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("stream"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("id\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("extmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" urn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("ietf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("rtp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("hdrext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("sdes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("repaired"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rtp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("stream"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("id\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sendrecv  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//表示双向通信")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("msid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("KkpsjshfPosgbb1dOrXGfhlc2dLZfo9JDvBU c19a73d7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c40e"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("eac"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bec1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("719")]),s._v("c3bd8c8e6\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtcp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("mux\n\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v(" opus"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48000")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//以上这行说明opus编码 支持使用rtcp来控制拥塞")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtcp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v(" transport"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cc\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("fmtp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v(" minptime"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("useinbandfec"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//对opus编码可选的补充说明,minptime代表最小打包时长是10ms，useinbandfec=1代表使用opus编码内置fec特性")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("103")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ISAC")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("104")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ISAC")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("G722")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PCMU")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PCMA")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("106")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("105")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),s._v(" telephone"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("event"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48000")]),s._v("\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rtpmap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("112")]),s._v(" telephone"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("event"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32000")]),s._v("\n↵ausM9\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ssrc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3967153627")]),s._v(" msid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("KkpsjshfPosgbb1dOrXGfhlc2dLZfo9JDvBU c19a73d7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c40e"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("eac"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bec1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("719")]),s._v("c3bd8c8e6\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//以上这一行定义了ssrc和WebRTC中的MediaStream,AudioTrack之间的关系，msid后面第一个属性是stream-d,第二个是track-id")]),s._v("\n\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ssrc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3967153627")]),s._v(" mslabel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("KkpsjshfPosgbb1dOrXGfhlc2dLZfo9JDvBU\n↵a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ssrc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3967153627")]),s._v(" label"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("c19a73d7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c40e"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("eac"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bec1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("719")]),s._v('c3bd8c8e6\n↵"\ntype'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"offer"')]),s._v("\n__proto__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" RTCSessionDescription\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("candiate 信息")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("candidate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("406917223")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" udp\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2122260223")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".106")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("53970")]),s._v("\ntyp host generation "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ufrag "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("h6t network"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[s._v("通信图示")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/webrtc.png",alt:"webrtc"}})])])])])},[],!1,null,null,null);t.default=r.exports}}]);